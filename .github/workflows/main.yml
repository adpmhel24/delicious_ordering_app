name: Build & Release

# This workflow is triggered on pushes to the repository.
on:
  pull_request:
    branches:
      - main
      - master

  push:
    branches:
    - main
    - master
    - develop
    
# on: push    # Default will running for every branch.
    
jobs:
  build:
    name: Build & Release
    # This job will run on ubuntu virtual machine
    runs-on: ubuntu-latest
    steps:

    # Login to API
    uses: JamesIves/fetch-api-data-action@v2.1.0
    with: 
      token-endpoint: http://122.54.198.84:82/api/auth/login?username=admin&password=10011992
      token-configuration: '{ "method": "GET" }'
      run: |
          echo "data: $data"
    
    # # Setup Java environment in order to build the Android app.
    # - uses: actions/checkout@v2
    # - uses: actions/setup-java@v1
    #   with:
    #     distribution: 'zulu'
    #     java-version: '11'
    
    # # Setup the flutter environment.
    # - uses: actions/checkout@v2
    # - uses: subosito/flutter-action@v2
    #   with:
    #     flutter-version: '2.8.1'
    #     channel: 'stable'
    
    # # Get flutter dependencies.
    # - run: flutter pub get
    
    # # Statically analyze the Dart code for any errors.
    # - run: flutter analyze .
    
    # # Run widget tests for our flutter project.
    # # - run: flutter test
    
    # # # Build appBundle.
    # # - run: flutter build appbundle

    # # Build apk.
    # - run: flutter build apk --split-per-abi
    
    # - uses: ncipollo/release-action@v1
    #   with:
    #     artifacts: build/app/outputs/flutter-apk/app.apk
    #     tag: v1.0.${{ github.run_number}}
    #     token: ${{ secrets.TOKEN}}